version: '3.8'

services:
  runic-converter:
    image: python:3.9-slim
    network_mode: "host"
    environment:
      - FLASK_ENV=production
      - FLASK_APP=app.py
      - FLASK_RUN_HOST=0.0.0.0
      - FLASK_RUN_PORT=5001
    working_dir: /app
    command: >
      sh -c "
      apt-get update && apt-get install -y git &&
      rm -rf /tmp/runic-converter &&
      git clone https://github.com/toroskilly/runic-converter.git /tmp/runic-converter &&
      cp -r /tmp/runic-converter/* /app/ &&
      pip install --no-cache-dir -r requirements.txt &&
      python app.py
      "
    restart: unless-stopped


